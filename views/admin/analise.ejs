<%- include("../partials/header") %>

<div class="container-fluid">
  <div class="row g-0">

    <!-- Sidebar -->
    <nav class="col-md-3 col-lg-2 d-flex flex-column p-3 min-vh-100">
      <%- include("../partials/navbar", { activePage: activePage }) %>
    </nav>

    <!-- ConteÃºdo -->
    <main class="col-md-9 col-lg-10 p-4">
      <h2 class="fw-bold text-center mb-4">ðŸ“Š AnÃ¡lise de Eventos</h2>
      <p class="text-center text-muted mb-5">
        Aqui vocÃª pode visualizar as principais estatÃ­sticas dos eventos realizados.
      </p>

      <div class="row g-4 justify-content-center">
        <!-- GrÃ¡fico 1 -->
        <div class="col-12 col-md-8 col-lg-6">
          <div class="card shadow-sm border-0 rounded-4 p-3 mb-4">
            <h5 class="fw-bold text-center">Eventos por MÃªs</h5>
            <canvas id="eventosMes" style="width: 100%; max-height: 250px;"></canvas>
          </div>
        </div>

        <!-- GrÃ¡fico 2 -->
        <div class="col-12 col-md-8 col-lg-6">
          <div class="card shadow-sm border-0 rounded-4 p-3 mb-4">
            <h5 class="fw-bold text-center">Dias mais procurados</h5>
            <canvas id="diasProcurados" style="width: 100%; max-height: 250px;"></canvas>
          </div>
        </div>

        <!-- GrÃ¡fico 3 -->
        <div class="col-12 col-md-8 col-lg-6">
          <div class="card shadow-sm border-0 rounded-4 p-3 mb-4">
            <h5 class="fw-bold text-center">Tipos de eventos mais realizados</h5>
            <canvas id="tiposEventos" style="width: 100%; max-height: 250px;"></canvas>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<%- include("../partials/footer") %>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const estatisticas = <%- JSON.stringify(estatisticas) %>;

  // Eventos por mÃªs
  new Chart(document.getElementById('eventosMes'), {
    type: "bar",
    data: {
      labels: estatisticas.eventosPorMes.labels,
      datasets: [{
        label: "Eventos",
        data: estatisticas.eventosPorMes.values,
        backgroundColor: "rgba(13, 110, 253, 0.6)"
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  // Dias mais procurados
  new Chart(document.getElementById("diasProcurados"), {
    type: "doughnut",
    data: {
      labels: estatisticas.diasMaisProcurados.labels,
      datasets: [{
        data: estatisticas.diasMaisProcurados.values,
        backgroundColor: ["#0d6efd", "#ffc107", "#198754"]
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  // Tipos de eventos
  new Chart(document.getElementById("tiposEventos"), {
    type: "pie",
    data: {
      labels: estatisticas?.tiposEventos?.labels || [],
      datasets: [{
        data: estatisticas?.tiposEventos?.values || [],
        backgroundColor: ["#dc3545", "#0d6efd", "#ffc107", "#198754"]
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
</script>
